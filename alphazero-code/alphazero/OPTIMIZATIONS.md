# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ AlphaZero Training

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. **True Batch MCTS** (10-20x —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
- –ò–≥—Ä–∞–µ—Ç **32 –∏–≥—Ä—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –≤–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ë–∞—Ç—á–∏—Ç **–≤—Å–µ leaf evaluations** –≤ –æ–¥–∏–Ω GPU call
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **148 searches/sec** (batch_size=32, sims=100)

### 2. **AMP (Automatic Mixed Precision) —Å BF16** (1.5-2x —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç BF16 –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ RTX 5080
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **8466 samples/sec** –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏

### 3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—É—Ñ–µ—Ä**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `deque` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Non-blocking transfers –Ω–∞ GPU
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

### 4. **TF32 –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
- –í–∫–ª—é—á–µ–Ω –Ω–∞ RTX 5080
- –£—Å–∫–æ—Ä—è–µ—Ç matmul –æ–ø–µ—Ä–∞—Ü–∏–∏

### 5. **torch.compile()**
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
- –†–µ–∂–∏–º `reduce-overhead` –¥–ª—è inference

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Batch MCTS Performance:
```
batch_size=8,  sims=100:  49.9 searches/sec  (20.1ms/game)
batch_size=16, sims=100:  89.4 searches/sec  (11.2ms/game)
batch_size=32, sims=100: 148.3 searches/sec  (6.7ms/game) ‚≠ê
batch_size=32, sims=200:  73.4 searches/sec  (13.6ms/game)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** `batch_size_games=32`, `simulations=100-200`

### Training Performance:
- **8466 samples/sec** –ø—Ä–∏ batch_size=1024
- **11.8 —Å–µ–∫—É–Ω–¥** –Ω–∞ 100k samples (1 epoch)

### Self-Play Performance:
- **0.5-1 games/sec** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã –∏–≥—Ä—ã)
- –° batch MCTS: **~30-35 —Å–µ–∫—É–Ω–¥** –Ω–∞ batch –∏–∑ 16 –∏–≥—Ä

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (1-2 —á–∞—Å–∞):
```bash
python train_fast.py \
    --games 100 \
    --simulations 100 \
    --batch-games 32 \
    --batch-size 1024 \
    --iterations 50
```

### –î–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (4-6 —á–∞—Å–æ–≤):
```bash
python train_fast.py \
    --games 200 \
    --simulations 200 \
    --batch-games 32 \
    --batch-size 1024 \
    --iterations 100
```

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∏–ª—ã (12+ —á–∞—Å–æ–≤):
```bash
python train_fast.py \
    --games 300 \
    --simulations 200 \
    --batch-games 32 \
    --batch-size 1024 \
    --iterations 150
```

## üìà –û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å | –ù–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|-----------|----------------|----------------|-----------|
| MCTS (single) | ~0.1-0.5 games/s | 148 searches/s | **10-20x** |
| Training | ~2000 samples/s | 8466 samples/s | **4x** |
| Self-play | ~0.1 games/s | 0.5-1 games/s | **5-10x** |

**–û–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** **30-50x** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Batch MCTS:
- –°–æ–±–∏—Ä–∞–µ—Ç leaf states –∏–∑ –≤—Å–µ—Ö –∏–≥—Ä –≤ –±–∞—Ç—á
- –û–¥–∏–Ω GPU call –≤–º–µ—Å—Ç–æ N –æ—Ç–¥–µ–ª—å–Ω—ã—Ö
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞—Å—Ç–µ—Ç —Å —Ä–∞–∑–º–µ—Ä–æ–º –±–∞—Ç—á–∞

### AMP:
- BF16 –¥–ª—è forward pass (2x –±—ã—Å—Ç—Ä–µ–µ)
- FP32 –¥–ª—è backward pass (—Ç–æ—á–Ω–æ—Å—Ç—å)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏:
- `deque` –≤–º–µ—Å—Ç–æ `list` –¥–ª—è –±—É—Ñ–µ—Ä–∞
- Non-blocking transfers
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–æ–≤

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **batch_size_games** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞—Ç–µ–Ω `games_per_iteration` –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
2. **simulations** –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 100-150 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ batch MCTS
3. **batch_size** –¥–ª—è training –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 1024-2048 –Ω–∞ RTX 5080
4. AMP —Ç—Ä–µ–±—É–µ—Ç BF16 support (RTX 5080 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å GPU utilization (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >80%)
3. –°—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ vs —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è
4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á–∏—Ç—å batch_size_games –¥–æ 64

